/*! jquery.a11yTree */
!function(a,b,c,d){function e(b,c){this.element=b,this.options=a.extend({},defaults,c),this._defaults=defaults,this.init()}var f="a11yTree",g="plugin_",h="ul",i="li",j="tabindex",k="0",l="keydown",m="click",n="role",o="aria-level",p="tree",q="treeitem",r="group",s="has-children",t="no-children",u="toggle",v="."+u;defaults={customToggle:{html:d,onExpandCallback:function(){},onCollapseCallback:function(){}}},e.prototype={init:function(){var b=a(this.element);this.identifyChildren(b,p,1,this.options.customToggle),this.addToggleClick(b),this.addKeyBoardNav(b,this.options.customToggle)},addToggleClick:function(b){var c=this,d="default-toggle",e="";c.options.customToggle.html&&(d="custom-toggle",e=c.options.customToggle.html),b.find(".has-children").prepend('<div class="'+u+" "+d+'" aria-hidden="true">'+e+"</div>"),b.find(v).on(m,function(){var b=a(this).parent(i);c.isCollapsed(b)?c.expand(b):c.collapse(b)})},addKeyBoardNav:function(a){this.addTreeItemsToTabOrder(a),this.handleArrowKeys(a)},handleArrowKeys:function(a){var b=this;a.on(l,function(c){var d=a.find("li:focus");40===c.which?b.handleDownArrowKey(d):38===c.which?b.handleUpArrowKey(d):39===c.which?b.handleRightArrowKey(d):37===c.which&&b.handleLeftArrowKey(d)})},addTreeItemsToTabOrder:function(a){a.find(i).attr(j,k)},handleLeftArrowKey:function(a){this.isExpanded(a)?this.collapse(a):this.focusOn(this.findParent(a))},handleRightArrowKey:function(a){this.isCollapsed(a)?this.expand(a):this.isExpanded(a)&&this.focusOn(this.findFirstChild(a))},handleUpArrowKey:function(a){if(this.isExpanded(a.prev())){var b=a.prev().children(h);this.focusOn(this.findLastChild(b).focus())}else this.focusOn(0===a.prev().length?this.findParent(a):a.prev())},handleDownArrowKey:function(a){this.focusOn(this.hasChildren(a)&&this.isExpanded(a)?this.findFirstChild(a):0===a.next().length?this.findParent(a).next():a.next())},hasChildren:function(a){return a.hasClass(s)},focusOn:function(a){a.focus()},expand:function(a){this.options.customToggle.onExpandCallback&&this.options.customToggle.onExpandCallback(a),a.attr("aria-expanded","true")},collapse:function(a){this.options.customToggle.onCollapseCallback&&this.options.customToggle.onCollapseCallback(a),a.attr("aria-expanded","false")},isExpanded:function(a){return"true"===a.attr("aria-expanded")},isCollapsed:function(a){return"false"===a.attr("aria-expanded")},findParent:function(a){return a.parent(h).parent(i)},findLastChild:function(a){return a.find(" > li:last-child")},findFirstChild:function(a){return a.children(h).find(" > li:nth-child(1)")},identifyListItemWithChildren:function(a){this.collapse(a),a.addClass(s)},identifySubChildren:function(a,b){var c=a.children(h);c.length>0?(this.identifyListItemWithChildren(a),this.identifyChildren(c,r,b+1)):a.addClass(t)},identifyChildren:function(b,c,d){var e=this;b.attr(n,c);var f=b.children(i);f.attr(n,q).attr(o,d),f.each(function(){e.identifySubChildren(a(this),d)})}},a.fn[f]=function(b){return this.each(function(){a.data(this,g+f)||a.data(this,g+f,new e(this,b))})}}(jQuery,window,document);